# Excel_login_out
エクセルVBAでlogin、logoutを実行

ｅ支店APIのサンプルコード（Excel VBA）

ファイル名: e_api_login_out.xlsm

APIバージョン： v4r2で動作確認

ご注意！！ ================================

	APIは、本番環境に接続した場合、実際に注文を出せます。
	市場で条件が一致して約定した場合、取り消せません。
	十分にご注意いただき、ご利用ください。

=========================================

1）動作テストを実行した環境

	os: Windows 10 Pro、21H1

	Excel:  2016 MSO(16.0.4266.1001) 64ビット

２）エクセルの設定

     メニュー「ツール」「参照設定」の「参照可能なライブラリファイル」で以下の２つにチェックが入っていること必要です。

	「Microsoft XML, v6.0」

	「Microsoft Scripting Runtime」

	（ VBA-JSONは「Dictionary」を利用しているので、「Microsoft Scripting Runtime」の参照設定が必要です。） 

３）APIの利用には、事前に立花証券ｅ支店に口座開設が必要です。

４）利用時にシート「設定」のB列の変数を設定してください。

	api接続url

	ログインＩＤ

	ログイン用パスワード（第1）

	注文用パスワード1（第２）

	sJsonOfmt（json表示形式）

	を実際のurl、ご自身のユーザーID、パスワード等に変更してください。

	変更しない場合、正常に動作しません。

５)実行はシート「設定」の「サンプルコードの起動」で行ってください。

  実行内容は、以下になります。

	a）ログインして仮想URL（request）と仮想URL（event）を取得する。

	b）ログアウトを実行する。

	上記に付随して、送信データや受信データを適宜Debug.Print文で出力します。

	シート「api_respons」にAPIへの送信内容と返信内容を記録します。

６）取得した文字列に日本語が入った場合、文字コードはshift-jisです。

７）利用時間外に接続した場合、"p_errno":"9"（システム、サービス停止中。）が返されます。詳しくは「立花証券・ｅ支店・ＡＰＩ、EVENT I/F 利用方法、データ仕様」4ページをご参照ください。

なお現在、デモ環境はサービスの提供を停止しています。

８）本サンプルプログラムは、事務方の者が休日や空き時間に作成したため、色々足りておりません。ご容赦ください。

９）本プログラムは自由にご使用ください。

１０）このソフトウェアを使用したことによって生じたすべての障害・損害・不具合等に関して、私と私の関係者および私の所属するいかなる団体・組織とも、一切の責任を負いません。各自の責任においてご使用ください。
